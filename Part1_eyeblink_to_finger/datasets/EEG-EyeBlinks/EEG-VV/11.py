import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import welch

# Given array
data = np.array([28848.77, 28854.94, 28835.49, 28847.45, 28860.21, 28861.06, 28848.26, 28827.,
                 28839.25, 28855.39, 28855.99, 28851.77, 28845.17, 28856.3, 28846.11, 28843.4,
                 28856.12, 28879.48, 28862.05, 28844.7, 28847.29, 28865.6, 28859.97, 28836.74,
                 28828.09, 28830.6, 28837.46, 28821.1, 28820.38, 28838.02, 28849.11, 28825.46,
                 28809.03, 28832.54, 28838.49, 28825.72, 28830.49, 28824., 28847.52, 28848.86,
                 28825.77, 28825.88, 28833.5, 28837.28, 28827.6, 28825.9, 28836.43, 28827.38,
                 28815., 28802.81, 28821.59, 28843.32, 28815.89, 28820.63, 28840.97, 28835.96,
                 28822.13, 28818.64, 28810.77, 28841.04, 28827., 28817.54, 28833.06, 28836.3,
                 28825.97, 28810.46, 28806.99, 28816.72, 28834.46, 28823.15, 28811.93, 28814.57,
                 28824.74, 28810.75, 28804.31, 28825.84, 28819.96, 28812.07, 28815., 28817.5,
                 28824.76, 28823., 28795.55, 28802.26, 28818.62, 28804.67, 28801.14, 28797.81,
                 28812.81, 28806.39, 28799.24, 28789.38, 28795.35, 28809.97, 28795.48, 28792.24,
                 28801.43, 28808.87, 28784.24, 28793.47, 28812.43, 28804.85, 28787.15, 28771.12,
                 28787.17, 28796.51, 28797.23, 28773.33, 28790.41, 28793.58, 28786.19, 28789.25,
                 28784.75, 28792.53, 28775.72, 28799.06, 28802.88, 28796.33, 28785.27, 28779.12,
                 28786.95, 28802.1, 28801.85, 28788.78, 28794.14, 28797.47, 28796.87, 28776.95,
                 28782.88, 28802.37, 28801.41, 28790.19, 28779.46, 28792.53, 28795.04, 28790.01,
                 28794.54, 28795.06, 28804.96, 28802.32, 28781.58, 28782.74, 28793.87, 28790.63,
                 28793.81, 28797.12, 28821.32, 28828.77, 28803.42, 28797.61, 28805.23, 28814.37,
                 28807.42, 28802.55, 28809.79, 28815.64, 28824.94, 28818.91, 28814.55, 28819.89,
                 28805.52, 28799.64, 28797., 28818.55, 28827.09, 28823.45, 28823.71, 28817.52,
                 28811.98, 28804.31, 28803.44, 28814.55, 28822.04, 28838.06, 28836.48, 28828.45,
                 28835.07, 28818.42, 28808.29, 28828.23, 28829.68, 28822.01, 28822.64, 28839.7,
                 28848.14, 28843.38, 28839.02, 28843.7, 28855.54, 28854.83, 28852.08, 28848.63,
                 28876.26, 28878.1, 28860.97, 28854.2, 28859.72, 28859.23, 28832.97, 28827.18,
                 28857.6, 28869.82, 28853.11, 28854.78, 28859.54, 28871.37, 28863.25, 28847.43,
                 28853.44, 28883.66, 28880.17, 28866.25, 28867.59, 28870.47, 28863.99, 28859.63,
                 28859.1, 28872.22, 28895.02, 28879.55, 28869.98, 28886.81, 28891.64, 28883.41,
                 28878.59, 28892.74, 28908.54, 28893.9, 28872.26, 28881.22, 28897.61, 28895.62,
                 28875.68, 28884.94, 28887.75, 28892.6, 28899.6, 28905.25, 28905.7, 28909.83,
                 28907.6, 28900.31, 28913.54, 28928.03, 28925.46, 28905.34, 28927.94, 28932.63,
                 28924.88, 28910.66, 28915.82, 28930.58, 28923.74, 28914.53, 28923.92, 28934.6,
                 28932.46, 28914.57, 28922.44, 28932.14, 28930.44, 28943.56, 28944.14, 28954.63,
                 28951.41, 28941.46, 28939.38, 28946.13, 28941.69, 28922.64, 28946.31, 28955.5,
                 28957.98, 28958.49, 28946., 28952.62, 28963.63, 28944.9, 28940.39, 28954.85,
                 28981.34, 28980.8, 28966.99, 28963.9, 28976.71, 28974.54, 28965.58, 28970.18,
                 28987.6, 28986.59, 28981.47, 28977.54, 29005.5, 29004.45, 28974.52, 28974.63,
                 29005.43, 29017.53, 29009.81, 29004.27, 29008.23, 29015.56, 29007., 29001.68,
                 29017.32, 29031.9, 29018.15, 29016.1, 29022.71, 29023.11, 29018.84, 29004.03,
                 28995.35, 29021.1, 29028.84, 29018.82, 29024.72, 29035.88, 29039.45, 29027.74,
                  29015.45, 29029.86, 29034.83, 29025.64, 29018.82, 29021.84, 29040.59, 29048.77,
                  29028.75])

# Sampling frequency
fs = 250.0

# Compute the Power Spectral Density (PSD)
frequencies, psd = welch(data, fs, nperseg=250)

# Plot the PSD
plt.figure(figsize=(10, 6))
plt.semilogy(frequencies, psd)
plt.title('Power Spectral Density')
plt.xlabel('Frequency (Hz)')
plt.ylabel('Power/Frequency (dB/Hz)')
plt.grid()
plt.show()